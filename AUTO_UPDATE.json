{
  "name": "AUTO_UPDATE",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtHour": 3
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1200,
        -512
      ],
      "id": "487592e3-3f19-4fac-86e0-961450578f87",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "command": "sudo ./update.sh",
        "cwd": "=/home/yourudername"
      },
      "type": "n8n-nodes-base.ssh",
      "typeVersion": 1,
      "position": [
        352,
        -496
      ],
      "id": "bf7571a7-dccc-49cc-94d8-717eac419245",
      "name": "VM1",
      "credentials": {
        "sshPassword": {
          "id": "1E48bpaACpmkikz1",
          "name": "SSH Password account"
        }
      }
    },
    {
      "parameters": {
        "command": "sudo ./update.sh",
        "cwd": "=/home/yourudername"
      },
      "type": "n8n-nodes-base.ssh",
      "typeVersion": 1,
      "position": [
        -176,
        -496
      ],
      "id": "ccf4e965-090d-439a-8216-7cc3ea5482fe",
      "name": "VM2",
      "credentials": {
        "sshPassword": {
          "id": "9qyJFGKxfSpKJlEl",
          "name": "SSH Password account"
        }
      }
    },
    {
      "parameters": {
        "command": "sudo ./update.sh",
        "cwd": "=/home/yourudername"
      },
      "type": "n8n-nodes-base.ssh",
      "typeVersion": 1,
      "position": [
        -672,
        -512
      ],
      "id": "61059fe6-8502-4a43-8c27-b5a56c382b1e",
      "name": "VM3",
      "credentials": {
        "sshPassword": {
          "id": "1E48bpaACpmkikz1",
          "name": "SSH Password account"
        }
      }
    },
    {
      "parameters": {
        "content": "# Ubuntu Auto Update & Upgrade Script Setup\n\nThis guide walks you through creating, configuring, and running an auto-update script on Ubuntu without needing a sudo password (restricted only to this script).\n\n---\n\n",
        "height": 256,
        "width": 704
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -624,
        -1264
      ],
      "typeVersion": 1,
      "id": "8a916f98-7d0f-4e23-9f7f-a2c68e0962fa",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Steps\n\n1. **Create the script file**  \n   ```bash\n   nano update.sh\n   ```\n\n2. **Paste the following script content**  \n   ```bash\n   #!/bin/bash\n   # Auto Update & Upgrade Script for Ubuntu\n\n   # Exit immediately if a command exits with a non-zero status\n   set -e\n\n   echo \"========================================\"\n   echo \"  Starting System Update & Upgrade...\"\n   echo \"========================================\"\n\n   # Update package list\n   sudo apt update -y\n\n   # Upgrade packages\n   sudo apt upgrade -y\n\n   # Full distribution upgrade (handles kernel & dependencies)\n   sudo apt full-upgrade -y\n\n   # Remove unnecessary packages\n   sudo apt autoremove -y\n   sudo apt autoclean -y\n\n   echo \"========================================\"\n   echo \"  System Update & Upgrade Completed!\"\n   echo \"========================================\"\n   ```\n\n",
        "height": 688,
        "width": 656
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1328,
        -1232
      ],
      "typeVersion": 1,
      "id": "6f122b77-991c-4fad-8435-5dece543f5dd",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "1.\n2.\n3. **Make the script executable**  \n   ```bash\n   chmod +x update.sh\n   ```\n\n4. **Edit sudoers file to allow passwordless execution of this script only**  \n   ```bash\n   sudo visudo\n   ```\n   Add this line at the end (replace `yourusername` with your actual username):  \n   ```\n   yourusername ALL=(ALL) NOPASSWD: /home/yourusername/update.sh\n   ```\n\n5. **Run the script**  \n   ```bash\n   sudo ./update.sh\n   ```\n\n",
        "height": 448,
        "width": 832
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -640,
        -992
      ],
      "typeVersion": 1,
      "id": "6176b10d-56c2-495e-8918-4318db6f3f87",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "1.\n2.\n3.\n4.\n5.\n6. **Connect via SSH to your instance**  \n   - Enter your **SSH credentials** to access the server.  \n\n7. **Run the script on the instance**  \n   ```bash\n   sudo ./update.sh\n   ```\n8. **Ensure you are in the correct directory** where the script is stored:  \n   ```bash\n   cd /home/yourusername\n   ```\n---\n## (Optional) Automate with Cron\n\nTo schedule this script to run daily at 2 AM:  \n\n```bash\ncrontab -e\n```\n\nAdd this line:  \n```bash\n0 2 * * * sudo /home/yourusername/update.sh >> /var/log/update.log 2>&1\n```\n---\nâœ… Done! Your Ubuntu system will now auto-update safely with no sudo password prompt, restricted only to this script.\n",
        "height": 704,
        "width": 624
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        208,
        -1248
      ],
      "typeVersion": 1,
      "id": "071fc860-973c-495a-95c4-bb2deb2b8cbe",
      "name": "Sticky Note3"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "nginx",
            "type": "main",
            "index": 0
          },
          {
            "node": "Vaultwarden",
            "type": "main",
            "index": 0
          },
          {
            "node": "pinhole/n8n",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "ox8cAUxso8tmFAsh"
  },
  "versionId": "3b16380e-cdc3-4fc6-bb90-63c818e407ed",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "cb1f5d0f7e02fdecbd23c39b504014986b42de3582b9b64f6bd9fd3e8523b487"
  },
  "id": "ox8cAUxso8tmFAsh",
  "tags": []
}
